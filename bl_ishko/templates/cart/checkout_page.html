{% extends 'shop/base.html' %}

{% load static %}
{% load mathfilters %}

{% block title %}ОФОРМЛЕНИЕ ЗАКАЗА{% endblock title %}

{% block header %}
  {% include 'shop/includes/header-light.html' %}
{% endblock header %}

{% block content %}

  <!-- CONTENT START -->
  <div class="content"> 
    
    <!--======= SUB BANNER =========-->
    <section class="sub-banner">
      <div class="container">
        <h4>ОФОРМЛЕНИЕ ЗАКАЗА</h4>
        <!-- Breadcrumb -->
        <ol class="breadcrumb">
          <li><a href="{% url 'shop:home-page' %}">Главная</a></li>
          <li class="active">ОФОРМЛЕНИЕ ЗАКАЗА</li>
        </ol>
      </div>
    </section>
    
    <!--======= PAGES INNER =========-->
    <section class="section-p-30px pages-in chart-page">
      <div class="container"> 
        
        <!-- Payments Steps -->
        <div class="payment_steps">
          <ul class="row">
            <!-- SHOPPING CART -->
            <li class="col-sm-4"> <i class="fa fa-shopping-cart"></i>
              <h6>КОРЗИНА</h6>
            </li>
            
            <!-- CHECK OUT DETAIL -->
            <li class="col-sm-4 current"> <i class="fa fa-align-left"></i>
              <h6>ОФОРМЛЕНИЕ ЗАКАЗА</h6>
            </li>
            
            <!-- ORDER COMPLETE -->
            <li class="col-sm-4"> <i class="fa fa-check"></i>
              <h6>ГОТОВО</h6>
            </li>
          </ul>
        </div>
        
        <!-- Payments Steps -->
        <div class="shopping-cart"> 
          
          <!-- SHOPPING INFORMATION -->
          <div class="cart-ship-info">
            <div class="row"> 
              
              <!-- ESTIMATE SHIPPING & TAX -->
              <div class="col-sm-7">
                <h6>ДЕТАЛИ ЗАКАЗА</h6>
                <form action="{% url 'cart:order-complete-page-intermediate' %}">
                  <ul class="row">
                    <!-- Name -->
                    <li class="col-md-6">
                      <label> *ИМЯ
                        <input type="text" name="first-name" value="{% if user.first_name %}{{ user.first_name }}{% endif %}" placeholder="" required>
                      </label>
                    </li>
                    <!-- LAST NAME -->
                    <li class="col-md-6">
                      <label> *ФАМИЛИЯ
                        <input type="text" name="last-name" value="{% if user.last_name %}{{ user.last_name }}{% endif %}" placeholder="" required>
                      </label>
                    </li>
                    <!-- *COUNTRY -->
                    <li class="col-md-12">
                      <label> *СТРАНА
                        <select class="selectpicker">
                          <option>РОССИЯ</option>
                        </select>
                      </label>
                    </li>
                    <!-- COUNTRY -->
                    <li class="col-md-6">
                      <label> РЕГИОН
                        <input type="text" name="region" value="{% if user.info.region %}{{ user.info.region }}{% endif %}" placeholder="Краснодарский край">
                      </label>
                    </li>
                    
                    <!-- POSTCODE -->
                    <li class="col-md-6">
                      <label> *ПОЧТОВЫЙ ИНДЕКС
                        <input type="number" name="postal-code" value="{% if user.info.index %}{{ user.info.index }}{% endif %}" placeholder="123456" max='999999' min="000001" required>
                      </label>
                    </li>

                    <!-- TOWN/CITY -->
                    <li class="col-md-12">
                      <label>*ГОРОД/НАСЕЛЕННЫЙ ПУНКТ
                        <input type="text" name="city" value="{% if user.info.city %}{{ user.info.city }}{% endif %}" placeholder="Сочи" required>
                      </label>
                    </li>
                    <li class="col-md-12"> 
                      <!-- ADDRESS -->
                      <label>*АДРЕС
                        <input type="text" name="address" value="{% if user.info.address %}{{ user.info.address }}{% endif %}" placeholder="улица Пушкинская, д. 25, кв. 10" required>
                        <!-- <input type="text" name="address" value="" placeholder="Optional"> -->
                      </label>
                    </li>
                    
                    <!-- EMAIL ADDRESS -->
                    <li class="col-md-6">
                      <label> *EMAIL 
                        <input type="email" name="email" value="{{ user.email }}" placeholder="" required>
                      </label>
                    </li>
                    <!-- PHONE -->
                    <li class="col-md-6">
                      <label> *ТЕЛЕФОН
                        <input type="tel" name="phone" placeholder="+7" value="{% if user.info.phone %}{{ user.info.phone }}{% endif %}" required>
                      </label>
                    </li>
                    
                    <!-- CREATE AN ACCOUNT -->
<!--                     <li class="col-md-6">
                      <div class="checkbox">
                        <input id="checkbox1" class="styled" type="checkbox">
                        <label for="checkbox1"> CREATE AN ACCOUNT ? </label>
                      </div>
                    </li>
      -->               
                    <!-- SHIP TO BILLING ADDRESS -->
<!--                     <li class="col-md-6">
                      <div class="checkbox">
                        <input id="checkbox2" class="styled" type="checkbox">
                        <label for="checkbox2"> SHIP TO BILLING ADDRESS? </label>
                      </div>
                    </li> -->
                  </ul>
                <!-- </form> -->
              </div>
              
              <!-- SUB TOTAL -->
              <div class="col-sm-5" style="margin-bottom: 50px;">
                <div class="order-place">
                  <h5>ВАШ ЗАКАЗ</h5>
                  <div class="order-detail">

                    <p>ТОВАР <span>СУММА</span></p>
                    <div class="item-order">
                      {% for order_item in order.order_items.all %}
                        <p>{{ order_item.item.product.title|upper }} - {{ order_item.item.size }} <span class="color"> x{{ order_item.quantity }} </span></p>
                        <p>ЦВЕТ: {{ order_item.item.product.color|upper }} </p>
                        <p class="text-right">{% if order_item.item.product.discount %}{{ order_item.item_total_with_sale }} RUB (sale {{ order_item.item.product.discount }}%){% else %}{{ order_item.item_total }} RUB{% endif %}</p>
                      {% endfor %}
                    </div>

                    <p>СУММА ЗАКАЗА <span>{{ order.get_order_total_price_with_sale }} RUB</span></p>

                    <p>ДОСТАВКА <span>500 RUB</span></p>
                    <div class="item-order" style="padding-top: 10px; padding-bottom: 10px;">
                      <p>ПО МОСКВЕ <span> Бесплатно???</span></p>
                      <p>СДЭК <span> В зависимости от города</span></p>
                      <p>ПОЧТА РОССИИ 1 КЛАСС <span>280 RUB</span></p>
                      <p>ПОЧТОЙ ЗА ГРАНИЦУ <span>500 RUB</span></p>
                    </div>
                    <p>ОБЩАЯ СУММА <span>{{ order.get_order_total_price_with_sale|addition:500 }} RUB</span></p>
                  </div>

                  <h5>СПОСОБЫ ОПЛАТЫ</h5>
                  <ul>
                    <li style="margin-top: 20px;">
                      <div class="checkbox">
                        <input id="checkbox-card" class="styled" type="checkbox" name="card_payment" checked>
                        <label for="checkbox-card" style="margin-bottom: 0px;"> ОНЛАЙН ПЕРЕВОД НА КАРТУ </label>
                      </div>
                      <p>Вы можете оплатить заказ с помощью перевода на банковскую карту по номеру телефона или номеру карты, которые вам предоставит администратор после подтверждения заказа.</p>
                    </li>
                    <li>
                      <div class="checkbox">
                        <input id="checkbox-cash" class="styled" type="checkbox" name="cash_payment">
                        <label for="checkbox-cash" style="margin-bottom: 0px;"> ОПЛАТА НАЛИЧНЫМИ ПРИ ПОЛУЧЕНИИ </label>
                      </div>
                      <p>Данный способ оплаты доступен только при условии самовывоза.</p>
                    </li>
                  </ul>
                  <button type="submit" class="btn btn-small btn-dark pull-right">ПОДТВЕРДИТЬ ЗАКАЗ</button> </div>
                </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
{% endblock content %}

{% block scripts %}
<script src="{% static 'js/jquery-1.11.3.js' %}"></script> 
<script src="{% static 'js/wow.min.js' %}"></script> 
<script src="{% static 'js/bootstrap.min.js' %}"></script> 
<script src="{% static 'js/own-menu.js' %}"></script> 
<script src="{% static 'js/owl.carousel.min.js' %}"></script> 
<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script> 
<script src="{% static 'js/jquery.isotope.min.js' %}"></script> 
<script src="{% static 'js/jquery.flexslider-min.js' %}"></script> 

<!-- SLIDER REVOLUTION 4.x SCRIPTS  --> 
<script type="text/javascript" src="{% static 'rs-plugin/js/jquery.themepunch.tools.min.js' %}"></script> 
<script type="text/javascript" src="{% static 'rs-plugin/js/jquery.themepunch.revolution.min.js' %}"></script> 
<script src="{% static 'js/main.js' %}"></script>
{% endblock scripts %}